# MicroBoard 機能説明書

## 📋 目次

- [コア機能](#コア機能)
- [掲示板システム](#掲示板システム)
- [会員管理](#会員管理)
- [ソーシャルログイン](#ソーシャルログイン)
- [ポイントシステム](#ポイントシステム)
- [プラグインシステム](#プラグインシステム)
- [多言語サポート](#多言語サポート)
- [管理者機能](#管理者機能)
- [セキュリティ機能](#セキュリティ機能)

---

## 🌟 コア機能

MicroBoard は軽量で高性能な掲示板システムです。複雑な大規模 CMS なしで強力なコミュニティプラットフォームを構築できます。

### 主な特徴

- ⚡ **軽量 & 高速**: 最小限の依存関係で最適化されたパフォーマンス
- 🌍 **グローバルサポート**: 4 言語サポート（韓国語、英語、日本語、中国語）
- 🔐 **強力なセキュリティ**: CSRF、SQL インジェクション、XSS 保護
- 📱 **レスポンシブデザイン**: すべてのデバイスで完璧なユーザーエクスペリエンス
- 🔌 **拡張可能**: プラグインシステムによる無限の拡張

---

## 📝 掲示板システム

### 基本掲示板機能

MicroBoard の掲示板は直感的で強力な機能を提供します。

#### ✨ 投稿作成

- **WYSIWYG エディタ**: Summernote エディタによるリッチテキスト編集
- **画像アップロード**: ドラッグアンドドロップによる簡単な画像添付
- **ファイル添付**: 様々なファイル形式のサポート
- **リアルタイムプレビュー**: 作成中の即時確認

#### 🔍 検索機能

- **統合検索**: タイトル、内容、作成者による検索
- **フィルタリング**: 特定のフィールドのみを選択して検索
- **並べ替え**: 最新順、閲覧数順の並べ替えサポート

#### 💬 コメントシステム

- **階層型コメント**: コメントと返信のサポート
- **リアルタイム登録**: ページの再読み込みなしでコメント作成
- **作成者表示**: コメント作成者情報の表示

#### 📊 閲覧数追跡

- **IP ベースの重複防止**: 重複閲覧数の防止
- **リアルタイム集計**: 閲覧数のリアルタイム更新

#### 📂 ファイル管理

- **複数ファイル添付**: 複数のファイルを同時にアップロード
- **ファイルダウンロード**: 添付ファイルのダウンロードとカウント
- **自動整理**: 投稿削除時に関連ファイルを自動削除

#### 📋 掲示板ディレクトリ

- **カード型レイアウト**: すべての掲示板を一目で確認できるカード形式のリスト
- **レスポンシブデザイン**: モバイルでもきれいに表示されるグリッドシステム
- **自動生成**: 掲示板追加時に自動的にリストに反映

---

## 👥 会員管理

### 会員登録と認証

#### 📋 会員登録

- **簡単な登録手順**: ID とパスワードのみで登録
- **リアルタイム重複チェック**: ID の重複を即座に確認
- **パスワード暗号化**: bcrypt を使用した安全なパスワード保存
- **入力検証**: サーバー側の入力値検証によるセキュリティ強化

#### 🔐 ログインシステム

- **セッション管理**: 安全なセッションベースの認証
- **自動ログアウト**: 30 分非アクティブ時に自動ログアウト
- **Remember Me**: ログイン状態の維持オプション
- **複数ログイン方法**: 通常ログイン + ソーシャルログイン

### 会員ランクシステム

#### 🏆 ランク管理

- **10 段階ランク**: 1~10 レベルの会員ランクシステム
- **ランク別権限**: ランクに基づく掲示板アクセス制御
- **自動昇格**: アクティビティポイントに基づく自動ランク調整（オプション）
- **手動管理**: 管理者が直接ランクを調整可能

#### 🚫 会員制裁

- **ブロック機能**: 問題のある会員のアクセスブロック
- **ブロック理由記録**: ブロック理由と日付の記録
- **ブロック解除**: 管理者がいつでもブロック解除可能
- **自動通知**: ブロックされた会員に理由を表示

#### 👤 会員プロフィール

- **活動履歴**: 作成した投稿とコメントの閲覧
- **ポイント履歴**: 獲得/減点ポイントの詳細記録
- **登録情報**: 登録日、最終ログイン日の表示

---

## 🔐 ソーシャルログイン (OAuth)

MicroBoard は主要なソーシャルプラットフォームとのシームレスな統合を提供します。

### サポートプラットフォーム

#### 🔵 Google OAuth

- **Google アカウントログイン**: Google アカウントでのワンクリックログイン
- **自動アカウント作成**: 初回ログイン時に自動で会員作成
- **プロフィール連携**: Google プロフィール情報の自動取得
- **設定**: [Google Cloud Console](https://console.cloud.google.com/)で設定

#### 🟢 LINE OAuth

- **LINE アカウントログイン**: LINE アプリと連携したログイン
- **モバイル最適化**: モバイル環境に最適化されたログインフロー
- **自動アカウント作成**: 初回ログイン時に自動で会員作成
- **設定**: [LINE Developers](https://developers.line.biz/)で設定

#### ⚫ Apple OAuth

- **Apple でログイン**: Apple ID を使用したセキュアログイン
- **プライバシー保護**: Apple の強力なプライバシー保護機能
- **iOS 最適化**: iOS/macOS デバイスでの最適化された体験
- **設定**: [Apple Developer](https://developer.apple.com/)で設定

### OAuth 機能

- ✅ **自動ボタン表示**: 設定完了時に自動でログインボタンを表示
- ✅ **状態表示**: 管理者ページで OAuth 設定ステータスを確認
- ✅ **CSRF 保護**: State パラメータによる CSRF 攻撃防止
- ✅ **エラーハンドリング**: 詳細なエラーメッセージとロギング
- ✅ **多言語サポート**: すべての OAuth フローでの多言語サポート

### 設定方法

1. 管理者ページにアクセス (`/admin/oauth.php`)
2. 各プラットフォームの Client ID と Secret を入力
3. 有効化チェックボックスを選択
4. 保存すると自動でログインボタンが表示される

---

## ⭐ ポイントシステム

会員の活動を奨励するポイントシステムです。

### ポイント獲得

#### 📝 投稿作成

- **自動獲得**: 投稿作成時に自動でポイント獲得
- **管理者設定**: 管理者が獲得ポイントを設定可能
- **差別獲得**: 掲示板別の異なるポイント設定（オプション）

#### 💬 コメント作成

- **コメントポイント**: コメント作成時にポイント獲得（オプション）
- **活動奨励**: 活発なコミュニティ参加を促進

### ポイント減点

#### 🗑️ 投稿削除

- **自動減点**: 投稿削除時に獲得したポイントを自動減点
- **悪用防止**: 繰り返しの作成/削除によるポイント獲得を防止

### ポイント管理

#### 📊 ポイント履歴

- **詳細記録**: すべてのポイント獲得/減点履歴を記録
- **日付別閲覧**: 日付別にポイント履歴を確認
- **理由表示**: ポイント変動の理由を明確に表示

#### ⚙️ 管理者設定

- **ON/OFF**: ポイントシステムの有効化/無効化
- **ポイント設定**: 投稿/コメントごとのポイント設定
- **手動付与**: 管理者が直接ポイントを付与/減点可能

---

## 🔌 プラグインシステム

MicroBoard は強力なフックベースのプラグインシステムを提供します。

### プラグイン構造

#### 📁 プラグインディレクトリ

```
/plugin
  /your_plugin_name
    - plugin.php (メインプラグインファイル)
    - config.json (プラグイン設定)
    - README.md (プラグイン説明)
```

### フックシステム

#### 🎯 イベントフック

MicroBoard は様々なタイミングでフックを実行します:

- `before_write`: 投稿作成前
- `after_write`: 投稿作成後
- `before_delete`: 投稿削除前
- `after_delete`: 投稿削除後
- `before_comment`: コメント作成前
- `after_comment`: コメント作成後
- `before_login`: ログイン前
- `after_login`: ログイン後

#### 📌 プラグイン登録

```php
// plugin.php例
add_event('after_write', function($post_data) {
    // 投稿作成後に実行されるコード
    error_log("新しい投稿が作成されました: " . $post_data['title']);
}, 10); // 優先度10
```

### プラグイン機能

#### ⚙️ プラグイン管理

- **自動ロード**: `/plugin`フォルダのプラグインを自動認識
- **有効化/無効化**: 管理者ページでプラグインの ON/OFF
- **掲示板別適用**: 特定の掲示板にのみプラグインを適用
- **優先順位**: 複数のプラグインの実行順序を制御

#### 🛠️ プラグイン例

```php
<?php
/**
 * Plugin Name: Hello World
 * Description: シンプルなプラグイン例
 * Version: 1.0.0
 */

// 投稿作成後にログを残す
add_event('after_write', function($post_data) {
    $log = "[" . date('Y-m-d H:i:s') . "] ";
    $log .= "新しい投稿: " . $post_data['title'];
    file_put_contents(__DIR__ . '/log.txt', $log . PHP_EOL, FILE_APPEND);
});

// コメント作成時に通知
add_event('after_comment', function($comment_data) {
    // メール通知、プッシュ通知などを実装
    notify_admin($comment_data);
});
?>
```

---

## 🌍 多言語サポート

MicroBoard はグローバルサービスのための完全な多言語サポートを提供します。

### サポート言語

#### 🇰🇷 韓国語 (Korean)

- 完璧な韓国語翻訳
- 韓国式の日付/時間形式
- 韓国サービスに最適化

#### 🇺🇸 英語 (English)

- ネイティブレベルの英語翻訳
- 国際標準の日付/時間形式
- グローバルサービスサポート

#### 🇯🇵 日本語 (Japanese)

- 自然な日本語翻訳
- 日本式の敬語表現
- 日本サービスに最適化

#### 🇨🇳 中国語 (Chinese)

- 正確な中国語翻訳（簡体字）
- 中国式の表現方法
- 中国サービスサポート

### 多言語機能

#### 🔄 自動言語検出

- **ブラウザ言語**: ユーザーのブラウザ設定を自動認識
- **IP ベース**: IP アドレスによる国判別（オプション）
- **クッキー保存**: 選択した言語を自動保存

#### 🎛️ 言語切り替え

- **言語セレクタ**: すべてのページに言語選択メニュー
- **即時切り替え**: ページの再読み込みなしで言語変更
- **URL パラメータ**: `?lang=ko`形式で言語指定

#### 📝 翻訳管理

- **言語ファイル**: `/lang/`フォルダに言語別 PHP ファイル
- **簡単な追加**: 新しい言語ファイルの追加のみで言語拡張
- **オーバーライド**: 特定の文言のみカスタマイズ可能

---

## 👨‍💼 管理者機能

強力で直感的な管理者ページを提供します。

### ダッシュボード

#### 📊 統計

- **会員統計**: 総会員数、新規登録者、アクティブ会員
- **投稿統計**: 総投稿数、日別投稿数
- **訪問者統計**: 日別訪問者数、ページビュー
- **システム情報**: サーバー状態、ディスク使用量

### 会員管理

#### 👥 会員リスト

- **全会員閲覧**: 登録日順、名前順で並べ替え
- **詳細情報**: 各会員の活動履歴とポイント
- **一括操作**: 複数の会員を同時に管理

#### 🔧 会員制御

- **ランク変更**: 一括または個別のランク変更
- **ブロック/解除**: 問題のある会員アカウントのブロックと解除
- **削除**: 会員と関連データの完全削除
- **ポイント管理**: ポイントの手動付与/減点

### 掲示板管理

#### 📋 掲示板設定

- **掲示板作成**: 新しい掲示板の作成
- **権限設定**: 読み取り/書き込み権限レベルの設定
- **スキン選択**: 掲示板別の異なるスキン適用
- **リスト数**: ページごとに表示する投稿数の設定

#### 🎨 スキン管理

- **スキンリスト**: インストールされたスキンのリスト閲覧
- **プレビュー**: スキン適用前のプレビュー
- **設定**: スキン別の詳細オプション設定

### OAuth 管理

#### 🔐 OAuth 設定

- **Google 設定**: Client ID、Secret の入力と有効化
- **LINE 設定**: Channel ID、Secret の管理
- **Apple 設定**: Team ID、Key ID、Private Key の管理
- **状態確認**: 各 OAuth 連携状態のリアルタイム確認

### システム設定

#### ⚙️ 基本設定

- **サイトタイトル**: サイト名と説明
- **管理者メール**: システム通知受信メール
- **デフォルト言語**: サイトのデフォルト言語設定
- **タイムゾーン**: サーバーのタイムゾーン設定

#### 💰 ポイント設定

- **ポイント使用**: ポイントシステムの ON/OFF
- **投稿ポイント**: 投稿作成時に付与するポイント
- **コメントポイント**: コメント作成時に付与するポイント
- **ログインポイント**: 日次ログインボーナスポイント

### ポリシー管理

#### 📜 ポリシーページと自動インストール

- **自動インストール**: インストール時に 4 言語（韓/英/日/中）の利用規約とプライバシーポリシーを自動登録
- **自動表示**: ユーザーの言語設定に合わせて該当言語のポリシーを自動表示
- **利用規約**: サービス利用規約の作成/編集
- **プライバシーポリシー**: プライバシーポリシーの管理
- **WYSIWYG エディタ**: ポリシー内容編集機
- **バージョン管理**: ポリシー変更履歴の保管

---

## 🔒 セキュリティ機能

MicroBoard は最新のセキュリティ技術でサイトを保護します。

### 認証セキュリティ

#### 🔐 パスワードセキュリティ

- **bcrypt 暗号化**: 業界標準のパスワードハッシュ
- **ソルト**: レインボーテーブル攻撃防止のための自動ソルト生成
- **再ハッシュ**: パスワード変更時の自動再ハッシュ

#### ⏰ セッションセキュリティ

- **セッションタイムアウト**: 30 分非アクティブ時に自動ログアウト
- **セッション再生成**: ログイン時にセッション ID を再生成
- **Secure Cookie**: HTTPS 環境での Secure フラグ使用

### 入力セキュリティ

#### 🛡️ SQL インジェクション防止

- **PDO Prepared Statements**: すべてのクエリに Prepared Statement 使用
- **入力値検証**: すべてのユーザー入力のサーバー側検証
- **タイプチェック**: 数値/文字列などのデータタイプの厳格な検証

#### 🚫 XSS 防止

- **htmlspecialchars**: 出力時にすべての HTML をエスケープ
- **DOM Purify**: クライアント側 XSS 防止
- **Content Security Policy**: CSP ヘッダーによるスクリプト挿入ブロック

#### 🔒 CSRF 防止

- **CSRF トークン**: すべてのフォームに CSRF トークン自動生成
- **トークン検証**: フォーム送信時にトークンの有効性検証
- **SameSite Cookie**: クッキーの SameSite 属性設定

### ファイルセキュリティ

#### 📁 アップロードセキュリティ

- **ファイルタイプ検証**: ホワイトリストベースのファイル拡張子検証
- **ファイルサイズ制限**: 最大アップロードサイズ制限
- **ファイル名ランダム化**: アップロードファイル名の自動変更
- **実行防止**: アップロードディレクトリでのスクリプト実行ブロック

### アクセス制御

#### 🚪 権限管理

- **レベルベースアクセス**: 会員ランク別アクセス制御
- **管理者認証**: 管理ページの二段階認証
- **IP ホワイトリスト**: 特定 IP のみ管理者アクセス許可（オプション）

#### 🔐 二段階認証 (2FA)

- **メールベース 2FA**: メールベースの二段階認証によるアカウントセキュリティ強化
- **認証アプリサポート**: Google Authenticator、Authy などの TOTP アプリと互換
- **QR コード設定**: QR コードスキャンによる簡単な設定
- **バックアップコード**: アカウント復旧用のワンタイムバックアップコード
- **管理者制御**: メール設定を通じたグローバルな 2FA 有効化/無効化
- **ユーザー制御**: ユーザーがプロフィール設定で 2FA を有効化/無効化可能
- **セキュアログイン**: ユーザーアカウントの追加セキュリティ層

#### 🎨 テーマカスタマイズ

- **ファビコンアップロード**: サイト用のカスタムファビコンをアップロード (ICO, PNG, JPG, GIF 形式)
- **ロゴアップロード**: サイト用のカスタムロゴをアップロード (PNG, JPG, GIF, SVG 形式)
- **サイズ制御**: ファビコン用の適切なサイズを選択 (16x16, 32x32, 64x64) とロゴ用のサイズ (150x40, 200x50, 250x60, 300x75)
- **セキュリティ**: ファイルサイズ検証 (最大 5MB)、MIME タイプ検証、SVG コンテンツのサニタイズ
- **プレビュー**: 現在のファビコンとロゴを寸法と共に表示
- **管理者制御**: 直感的な管理インターフェースを通じてサイトブランディングを管理

---

## 📦 追加機能

### 📮 メール通知（オプション）

- 会員登録歓迎メール
- コメント通知メール
- パスワード再設定メール
- 管理者通知メール

### � SEO 最適化

- メタタグ自動生成
- サイトマップ自動生成
- Robots.txt 管理
- URL 構造最適化

### � ロギング

- エラーログ記録
- アクセスログ記録
- 管理者作業ログ
- ログ保管と削除ポリシー

---

## � パフォーマンス最適化

### ⚡ キャッシング

- データベースクエリキャッシング
- ページキャッシング（オプション）
- 静的ファイルキャッシング

### 📉 最適化

- 画像自動圧縮
- CSS/JS 圧縮とマージ
- Lazy Loading
- CDN サポート

---

## � モバイルサポート

### � レスポンシブデザイン

- **完璧なレスポンシブ**: すべての画面サイズに最適化
- **タッチ最適化**: タッチインターフェースサポート
- **モバイルメニュー**: モバイル専用ナビゲーション
- **高速ローディング**: モバイル環境に最適化

---

## � アップデートとマイグレーション

### � アップデート

- **自動アップデートチェック**: 新しいバージョンを自動検出
- **ワンクリックアップデート**: ボタン一つでアップデート
- **自動バックアップ**: アップデート前の自動バックアップ

### � マイグレーション

- **データベースマイグレーション**: バージョン別 DB スキーマ自動アップデート
- **設定保存**: 既存の設定とデータを維持
- **ロールバックサポート**: 問題発生時に前のバージョンに復元

---

## 📞 サポートとコミュニティ

### � サポート

- **GitHub Issues**: バグレポートと機能提案
- **ドキュメント**: 詳細なオンラインドキュメント
- **FAQ**: よくある質問

### 🤝 コミュニティ

- **GitHub Discussions**: コミュニティディスカッション
- **貢献ガイド**: オープンソース貢献方法
- **プラグイン共有**: コミュニティプラグイン

---

## � ライセンス

MicroBoard は[MIT ライセンス](LICENSE)で配布されます。

---

**MicroBoard v1.0.0** | [Documentation](https://mytajimilife-coder.github.io/microboard/) | [GitHub](https://github.com/mytajimilife-coder/microboard)
